# 系统功能完善与修复计划

## 1. 账号管理功能完善

### 1.1 修复与优化内容
- **添加账号封禁与解封机制**：在AdminController中添加封禁/解封用户的API端点
- **完善账号状态管理**：确保用户状态（PENDING、ACTIVE、REJECTED、BANNED）流转正确
- **优化账号信息修改功能**：确保所有字段均可正确修改
- **完善密码修改功能**：添加当前用户密码修改接口

### 1.2 实现方案
- 在AdminController中添加`@PutMapping("/users/{id}/ban")`和`@PutMapping("/users/{id}/unban")`方法
- 在UserController中添加`@PutMapping("/password-change")`方法，允许当前用户修改密码
- 确保数据库User表包含完整的状态字段和相关约束

## 2. 修复user-api的404错误

### 2.1 问题分析
- user-api的`/api/users/me`接口返回404，需要检查该接口是否存在
- 检查UserController中是否缺少相关端点实现

### 2.2 修复方案
- 在UserController中添加`@GetMapping("/me")`方法，返回当前登录用户信息
- 确保所有API端点路径正确配置

## 3. 大模型对话功能测试与优化

### 3.1 测试内容
- 验证对话交互的流畅性与准确性
- 排查后端服务、数据库连接及相关组件可能存在的问题
- 测试多轮对话功能
- 测试模型选择功能

### 3.2 优化方案
- 确保ChatController的所有方法正常工作
- 优化对话历史存储与查询
- 完善模型配置管理

## 4. 日志导出功能实现

### 4.1 实现内容
- 在AdminController中添加日志导出API端点
- 支持按时间范围、操作类型等条件过滤日志
- 导出格式支持CSV、JSON等常用格式

### 4.2 实现方案
- 添加`@GetMapping("/logs/export")`方法，支持多种导出格式
- 使用Spring Boot的ResourceLoader和HttpServletResponse实现文件下载
- 确保导出的数据完整且格式正确

## 5. 反馈管理功能完善

### 5.1 测试内容
- 验证反馈状态修改功能是否正常工作
- 测试反馈列表查询功能
- 验证反馈处理流程

### 5.2 优化方案
- 确保`updateFeedback`方法正确实现
- 完善反馈处理流程，包括处理人、处理时间等信息

## 6. 前端页面优化

### 6.1 优化内容
- 账号管理页面：添加封禁/解封按钮，优化审批流程界面
- 对话界面：优化用户交互体验，添加模型选择功能
- 日志管理页面：添加导出按钮，优化日志查询界面
- 反馈管理页面：优化反馈状态修改功能，添加处理记录

## 7. 系统测试与验证

### 7.1 测试内容
- 所有核心功能的端到端测试
- 数据库连接测试
- 服务启动与停止测试
- 性能测试

### 7.2 验证标准
- 所有API端点返回正确的HTTP状态码
- 数据库中数据完整准确
- 前后端交互正常
- 用户界面友好易用

## 8. 服务启动与配置

### 8.1 启动顺序
1. 确保数据库服务正常启动
2. 启动admin-api服务（端口11025）
3. 启动user-api服务（端口11031）
4. 启动admin-web服务（端口13085）
5. 启动user-web服务（端口13089）

### 8.2 配置检查
- 验证数据库连接配置
- 验证JWT密钥配置
- 验证CORS配置
- 验证端口配置

## 9. 实施步骤

1. **阶段1**：完善账号管理功能（2天）
2. **阶段2**：修复user-api的404错误（1天）
3. **阶段3**：实现日志导出功能（1天）
4. **阶段4**：大模型对话功能测试与优化（2天）
5. **阶段5**：前端页面优化（2天）
6. **阶段6**：系统测试与验证（1天）

## 10. 预期结果

- 所有核心功能正常工作
- 前后端交互流畅
- 数据库数据完整准确
- 用户界面友好易用
- 系统运行稳定可靠