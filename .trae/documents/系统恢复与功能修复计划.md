# 系统恢复与功能修复计划

## 1. 紧急修复任务

### 1.1 统一数据库配置
**问题**：admin-api和user-api使用不同的H2数据库文件，导致数据孤岛
**解决方案**：
- 将两个服务配置为使用同一个H2数据库文件
- 确保数据模型兼容
- **文件**：
  - `admin-api/src/main/resources/application.yml`
  - `user-api/src/main/resources/application.yml`

### 1.2 修复管理员登录问题
**问题**：请求错误端口11027，应为11025
**解决方案**：
- 检查前端配置，确保API请求指向正确端口
- 验证admin-api的登录端点是否正常

### 1.3 修复对话功能
**问题**：发送信息无响应
**解决方案**：
- 检查前端发送逻辑与事件绑定
- 验证API请求是否正常发出
- 排查网络请求错误或跨域问题
- 修复后端接收与响应处理逻辑

## 2. 服务管理

### 2.1 服务端口验证
- 检查当前服务端口占用情况
- 确保各服务端口无冲突
- 调整配置文件中的端口设置

### 2.2 服务重启计划
- 按照顺序重启所有服务
- 验证各服务启动状态

## 3. 数据同步与恢复

### 3.1 数据库迁移
- 合并admin-api和user-api的数据库
- 确保所有表结构兼容
- 恢复之前的数据

### 3.2 管理员账号创建
- 创建3个管理员账号
- 确保账号具有正确的权限

## 4. 大模型与工作流配置

### 4.1 大模型API配置
- 验证大模型API连接参数
- 测试API调用

### 4.2 Bisheng工作流配置
- 配置bisheng工作流环境
- 测试工作流调用

## 5. 功能测试

### 5.1 对话功能测试
- 测试发送信息功能
- 验证消息状态反馈
- 测试多轮对话

### 5.2 管理页面测试
- 验证管理页面数据加载
- 测试用户管理功能
- 测试模型配置功能

## 6. 执行步骤

1. **统一数据库配置**：修改两个服务的application.yml文件，使用同一个H2数据库
2. **重启服务**：按照顺序重启所有服务
3. **恢复数据**：确保之前的数据被正确加载
4. **修复登录问题**：验证管理员登录功能
5. **修复对话功能**：解决发送信息无响应问题
6. **创建管理员账号**：创建3个管理员账号
7. **配置大模型和工作流**：验证大模型和工作流配置
8. **功能测试**：测试所有核心功能

## 7. 预期交付结果

- ✅ 所有服务正常运行
- ✅ 数据库数据同步完成
- ✅ 管理员登录功能正常
- ✅ 对话功能修复
- ✅ 3个管理员账号创建完成
- ✅ 大模型和工作流配置完成
- ✅ 所有功能测试通过