# 端口和服务问题解决方案

## 一、问题分析

1. **端口占用情况**：
   - 13080端口：LISTEN状态，但未找到对应进程
   - 13082端口：LISTEN状态，由node进程使用
   - 13088端口：LISTEN状态，但未找到对应进程

2. **前端服务问题**：
   - 服务正在运行，但遇到依赖问题：无法解析@vicons/ionicons5模块
   - 该模块未安装，导致前端页面无法正常加载

3. **后端服务问题**：
   - 服务未正常启动，可能是Java版本兼容性问题
   - Spring Boot 3.x需要Java 17，而当前环境只有Java 11

4. **数据库状态**：
   - 可能未正常运行或连接配置有问题

## 二、解决方案

### 1. 终止占用端口的进程

```bash
# 终止13080端口进程
fuser -k 13080/tcp

# 终止13088端口进程
fuser -k 13088/tcp

# 验证端口是否已释放
ss -tulnp | grep -E '13080|13088'
```

### 2. 安装缺失的前端依赖

```bash
# 进入前端目录
cd /data/webUI-java/user-web

# 安装缺失的依赖
npm install @vicons/ionicons5

# 验证依赖是否安装成功
npm list @vicons/ionicons5
```

### 3. 修复后端Java版本兼容性问题

```bash
# 修改pom.xml，将Java版本降低到11
vi /data/webUI-java/pom.xml

# 修改内容：
<properties>
  <java.version>11</java.version>
</properties>

# 重新构建后端项目
mvn clean package -DskipTests -pl user-api,admin-api -am
```

### 4. 启动数据库服务

```bash
# 检查PostgreSQL服务状态
systemctl status postgresql

# 如果未运行，启动服务
systemctl start postgresql

# 验证数据库连接
psql -h localhost -U postgres -d chatbot
```

### 5. 启动后端服务

```bash
# 启动user-api服务
java -jar /data/webUI-java/user-api/target/user-api-1.0.0.jar

# 启动admin-api服务
java -jar /data/webUI-java/admin-api/target/admin-api-1.0.0.jar
```

### 6. 重启前端服务

```bash
# 终止当前前端服务
kill $(lsof -t -i :13082)

# 重启前端服务
cd /data/webUI-java/user-web && npm run dev
```

### 7. 验证服务状态

```bash
# 检查所有服务端口
ss -tulnp | grep -E '13080|13082|13088'

# 测试前端页面访问
curl -I http://localhost:13080

# 测试API接口
curl -X GET http://localhost:13088/api/users
```

## 三、预期结果

1. 所有端口（13080、13082、13088）均被正确释放和使用
2. 前端服务成功启动，页面可以正常访问
3. 后端服务成功启动，API接口可以正常调用
4. 数据库连接正常，数据完整性得到验证
5. 所有功能模块均能正常工作

## 四、后续建议

1. 考虑升级Java版本到17，以支持Spring Boot 3.x的全部功能
2. 配置服务的自动启动脚本，确保服务在系统重启后能自动恢复
3. 实现服务监控和告警机制，及时发现和处理服务异常
4. 定期备份数据库和配置文件，确保数据安全
5. 考虑使用容器化部署，简化服务管理和升级流程